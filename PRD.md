# 外卖热量追踪 App（都市白领版）PRD

> 基于 `BRD.md v0.1` 输出的首版产品需求文档，聚焦 MVP（v1.0）可落地范围。

## 1. 文档信息
- 文档版本：v1.0（MVP PRD）
- 关联 BRD：`BRD.md`
- 产品形态：移动端 App（iOS / Android）
- 核心能力：拍照上传餐食 → 热量估算 → 个性化饮食建议 → 日/周复盘

---

## 2. 产品目标与范围

### 2.1 版本目标（v1.0）
1. 用户可在 10 秒内完成一餐记录并拿到热量结果。
2. 用户获得可执行的“下一餐建议”和“当日补救建议”。
3. 用户可查看当日与近 7 日热量趋势，形成基础反馈闭环。

### 2.2 非目标（v1.0 不做）
- 医疗诊断或慢病处方建议。
- 深度社交功能（社区、PK、排行榜）。
- 与硬件设备（手环/体脂秤）打通。

---

## 3. 用户分层与关键场景

### 3.1 用户分层
- 减脂白领：关注每日热量赤字与代餐建议。
- 体重维持人群：关注是否超标与饮食均衡。
- 健身入门用户：关注蛋白摄入与高热量食物识别。

### 3.2 Top 场景
1. 午餐场景：忙碌中快速拍照并查看热量区间。
2. 晚餐纠偏场景：白天超标后获得可执行补救方案。
3. 周复盘场景：查看超标分布与改善建议。

---

## 4. 信息架构（IA）

底部导航 3 Tab：
1. **记录（首页）**
   - 拍照入口
   - 今日摄入概览
   - 最近记录卡片
2. **分析**
   - 当日热量构成
   - 近 7 日趋势图
   - 高风险餐次提醒
3. **我的**
   - 目标设置（减脂/维持/增肌）
   - 身体数据（体重、身高、活动水平）
   - 订阅与权益

---

## 5. 功能需求清单（MVP）

## 5.1 F1 拍照上传与识别
**目标**：降低记录门槛，实现“1 次动作完成记录”。

### 功能描述
- 支持相机拍照、相册上传。
- 支持用户选择餐次：早餐/午餐/晚餐/加餐。
- 上传后进入识别中状态，返回热量估算结果。

### 业务规则
- 单次仅上传 1 张图片。
- 图片格式：jpg/png；大小 ≤ 10MB。
- 超时阈值：8 秒提示“网络或识别繁忙，请重试”。

### 验收标准
- 95% 请求在 10 秒内返回结果（含失败提示）。
- 上传失败具备明确错误文案与重试入口。

---

## 5.2 F2 热量估算结果页
**目标**：让用户“看懂 + 相信 + 愿意行动”。

### 功能描述
返回以下内容：
1. 总热量区间（示例：650–820 kcal）
2. 热量来源拆解（主食/蛋白/油脂/饮料）
3. 置信度标签（高/中/低）
4. 高风险提示（高油/高糖/高钠）

### 业务规则
- 展示区间值，不展示“精确值”。
- 若识别置信度低，则增加提示：建议补充描述（如“是否有甜饮”）。

### 验收标准
- 结果页信息完整率 100%。
- 风险标签与建议内容不冲突（规则校验通过率 100%）。

---

## 5.3 F3 饮食建议引擎（规则版）
**目标**：输出即时、可执行建议，提高用户行为转化。

### 功能描述
- 输出两类建议：
  1. 下一餐建议（如“主食减半 + 增加蔬菜”）
  2. 今日补救建议（如“晚间避免含糖饮料，增加 20 分钟快走”）

### 建议生成规则（v1.0）
- 根据“用户目标 + 当前餐次热量区间 + 风险标签 + 当日累计摄入”生成。
- 每次最多输出 3 条，避免信息过载。
- 建议文案采用“动作 + 数量 + 替代选项”模板。

### 验收标准
- 每次识别至少返回 1 条有效建议。
- 建议可执行性用户评分（5 分制）均值 ≥ 4.0（灰度目标）。

---

## 5.4 F4 记录与历史
**目标**：让用户形成复盘习惯，支持长期留存。

### 功能描述
- 今日记录列表：按时间倒序展示每餐。
- 近 7 天趋势图：每日摄入总量 + 达标状态。
- 单条记录可查看详情（图片、热量、建议、风险标签）。

### 业务规则
- 支持删除单条记录（软删除）。
- 当天无记录时展示引导卡（去拍照）。

### 验收标准
- 记录创建后 1 秒内在首页可见。
- 趋势图展示连续 7 日（无数据日期补 0）。

---

## 5.5 F5 目标与用户档案
**目标**：为个性化建议提供基础输入。

### 功能描述
- 首次启动引导填写：性别、年龄、身高、体重、活动水平、目标。
- 支持后续在“我的”页修改。

### 业务规则
- 目标选项：减脂 / 维持 / 增肌。
- 若信息缺失，则建议引擎降级为通用建议并给出完善引导。

### 验收标准
- 新用户档案填写完成率 ≥ 85%（灰度目标）。

---

## 6. 关键流程（User Flow）

### 6.1 首次使用流程
启动 App → 欢迎页 → 填写基础资料 → 进入首页 → 引导首次拍照 → 查看结果 → 保存记录。

### 6.2 日常记录流程
首页点击拍照 → 上传图片 → 选择餐次 → 识别结果 → 查看建议 → 保存并返回首页。

### 6.3 复盘流程
进入分析页 → 查看当日与 7 日趋势 → 点击异常天/餐次 → 查看详情与纠偏建议。

---

## 7. 页面级需求（简版）

## 7.1 首页（记录）
- 组件：拍照按钮、今日摄入进度、最近 3 条记录。
- 空状态：无记录时展示“立即拍照记录第一餐”。
- 关键埋点：home_view、tap_camera、view_recent_log。

## 7.2 上传页
- 组件：拍照/相册入口、餐次选择、上传进度。
- 异常态：网络失败、格式不支持、超时。
- 埋点：upload_start、upload_success、upload_fail。

## 7.3 结果页
- 组件：热量区间、来源拆解、风险标签、建议卡片、保存按钮。
- 交互：支持“换一组建议”（每日限 3 次）。
- 埋点：result_view、tap_save_log、tap_refresh_advice。

## 7.4 分析页
- 组件：今日汇总、7 日趋势、高风险提醒。
- 埋点：analysis_view、tap_day_detail。

## 7.5 我的页
- 组件：目标设置、个人数据、订阅入口。
- 埋点：profile_view、tap_edit_goal、tap_subscription_entry。

---

## 8. 数据与埋点需求

## 8.1 核心指标定义
- `meal_logs_uv`：当天至少记录 1 餐的独立用户数。
- `meals_per_user_per_week`：周内人均记录餐次。
- `advice_accept_rate`：查看建议后点击“采纳/保存”的比例。
- `d7_retention`：第 7 日回访并记录至少 1 餐的比例。

## 8.2 事件清单（MVP）
- 曝光：home_view、result_view、analysis_view
- 行为：tap_camera、upload_success、save_meal_log、accept_advice
- 异常：upload_fail、recognition_timeout、recognition_low_confidence

## 8.3 属性字段
- 用户属性：goal_type、activity_level、city_tier
- 记录属性：meal_type、calorie_min、calorie_max、risk_tags、confidence_level

---

## 9. 推荐与建议策略（v1.0 规则）

### 9.1 输入
- 用户目标（减脂/维持/增肌）
- 当餐热量区间与风险标签
- 当日累计摄入与剩余额度
- 餐次类型（午餐/晚餐等）

### 9.2 输出模板
- 下一餐建议模板：
  - 「下一餐建议：主食减少 `X`，蛋白增加 `Y`，优先选择 `Z`。」
- 当日补救模板：
  - 「今日补救：避免 `A`，增加 `B` 分钟低强度运动。」

### 9.3 安全边界
- 禁止输出疾病诊疗结论。
- 禁止“保证减重”类承诺。
- 所有建议附带“健康建议非医疗诊断”说明。

---

## 10. 非功能性需求（NFR）
- 性能：95 分位识别耗时 ≤ 10 秒。
- 可用性：核心链路可用性 ≥ 99.5%。
- 安全：图片存储加密，传输 HTTPS。
- 隐私：提供数据删除入口，遵循最小必要采集。
- 合规：建议文案需通过合规词库审核。

---

## 11. 版本规划

### v1.0（当前）
- 完成拍照识别、建议生成、历史趋势、目标设置。

### v1.1（预研）
- 接入“菜品描述补充输入”提升识别精度。
- 增加每日总结卡与连续打卡激励。

### v2.0（预研）
- 个性化策略模型升级（用户偏好学习）。
- 订阅权益分层与企业健康合作方案。

---

## 12. 上线验收清单（Go-Live Checklist）
1. 核心流程冒烟通过：上传→识别→建议→保存→分析。
2. 埋点联调完成并可回收核心指标。
3. 异常场景（网络、超时、低置信）文案与兜底机制可用。
4. 合规审核通过（免责声明、敏感词、医疗边界）。
5. 灰度方案与回滚预案准备完成。

---

## 13. 依赖与协作
- 算法：图像识别服务、置信度输出能力。
- 后端：日志、用户档案、统计聚合接口。
- 设计：拍照与结果页信息层级优化。
- 运营：建议文案库、饮食替换内容运营。
- 法务/合规：健康建议边界审核。

---

## 14. 开放问题（待评审）
1. 是否在 v1.0 引入“手动修正菜品”能力？
2. 免费版每日识别次数上限设为 3 次还是 5 次？
3. 结果页是否展示“同类外卖更优选项”卡片？
4. 灰度阶段主打减脂人群还是覆盖全部目标人群？
